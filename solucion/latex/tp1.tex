\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}

\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}

\sloppy

\hypersetup{%
 % Para que el PDF se abra a p�gina completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={C�tedra de Algoritmos y Estructuras de Datos II - DC - UBA},
 pdfkeywords={TADs b�sicos},
 pdfsubject={Tipos abstractos de datos b�sicos}
}

\parskip=5pt % 10pt es el tama�o de fuente

% Pongo en 0 la distancia extra entre �temes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Algoritmos y Estructuras de Datos II}
\rhead{$1^{\mathrm{er}}$ cuatrimestre de 2012}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\author{Algoritmos y Estructuras de Datos II, DC, UBA.}
\date{}
\title{Tipos abstractos de datos b�sicos}

\begin{document}
%Pagina de titulo e indice
\thispagestyle{empty}

\maketitle
\tableofcontents

\newpage

% TADs
\section{TAD \tadNombre{PJ}}
\section{TAD \tadNombre{Fantasma}}
\section{TAD \tadNombre{Juego}}

\begin{tad}{\tadNombre{Juego}}
    \tadGeneros{juego}
    \tadExporta{TODO}
    \tadUsa{\tadNombre{Habitacion}}

    \tadIgualdadObservacional{j}{j'}{juego}{$(n=0? \igobs m=0?)\ \yluego$\\ $(\neg(n=0?) \impluego (\text{pred}(n) \igobs \text{pred}(m)))$}
    \tadIgualdadObservacional{j}{j'}{juego}{
        (accionesPJs(j) $\igobs$ accionesPJs(j')) $\land$ \\
        (accionesFan(j) $\igobs$ accionesFan(j')) $\land$ \\
        (localizarJugadores(j) $\igobs$ localizarJugadores(j')) $\land$ \\
        (hab(j) $\igobs$ hab(j')) $\land$ \\
        (($\forall$ p : pj) (vivePJ?(j, p) \igobs vivePJ?(j', p))) $\land$ \\
        (($\forall$ f : fantasma) ((viveFan?(j, p) \igobs viveFan?(j', p)) $\land$ \\
                                   (ubicacionInicialFan(j, f) \igobs ubicacionInicialFan(j', f)))
    }

    
    \tadAlinearFunciones{ubicacionInicialFan}{conj(pj)/pjs, secu(accion)/as}

    \tadObservadores
        \tadOperacion{accionesPJs}{juego}{dicc(pj, secu(accion))}{}
        \tadOperacion{accionesFan}{juego}{dicc(pj, secu(accion))}{}
        \tadOperacion{hab}{juego}{hab}{}
        \tadOperacion{vivePJ?}{juego/j, pj/p}{bool}{p $\in$ jugadores(j)}
        \tadOperacion{viveFan?}{juego/j, fantasma/f}{bool}{f $\in$ fantasmas(j)}
        \tadOperacion{ubicacionInicialFan}{juego/j, fantasma/f}{ubicacion}{f $\in$ fantasmas(f)}
        \tadOperacion{localizarJugadores}{juego}{dicc(pj, ubicacion)}{}
    
    \tadGeneradores
        \tadOperacion{iniciar}
            {conj(pj)/pjs, secu(accion)/as, ubicacion/u, hab/h}
            {juego}
            {esConexa?(h) $\land$ $\neg$ $\emptyset$?(as) $\land$ $\neg$ $\emptyset$?(pjs) $\land$ esValida?(h, pos(u))}

        \tadOperacion{proxPaso}
            {juego/j, pj/p, accion/a}
            {juego}
            {p $\in$ jugadores(j) $\yluego$ vivePJ?(j, p) $\land$ $\neg$ termino?(j) $\land$ $\neg$ esMirar(a)}
    \tadOtrasOperaciones

    \tadAxiomas[\paratodo{nat}{n, m}]
    \tadAlinearAxiomas{pred(suc($n$))}
    \tadAxioma{$0=0?$}{true}

\end{tad}

\begin{tad}{\tadNombre{Accion}}
    \tadGeneros{accion}
    
    \tadExporta{observadores, generadores, genero, otras operaciones}

    \tadIgualdadObservacional{a}{a'}{accion}{
        esNada(a) $\igobs$ esNada(a') $\land$ \\
        esDisparar(a) $\igobs$ esDisparar(a') $\land$ \\
        esMover(a) $\igobs$ esMover(a') $\land$ \\
        esMirar(a) $\igobs$ esMirar(a') $\land$ \\
        ((esMover(a) $\lor$ esMirar(a)) $\impluego$ direccion(a) $\igobs$ direccion(a'))
    }

    \tadAlinearFunciones{posicionesAfectadasPor}{hab/h,ubicacion/u,secu(accion)}{secu(accion)}{}
    
    \tadObservadores
        \tadOperacion{esMover}{accion}{bool}{}
        \tadOperacion{esMirar}{accion}{bool}{}
        \tadOperacion{esDisparar}{accion}{bool}{}
        \tadOperacion{esNada}{accion}{bool}{}
        \tadOperacion{direccion}{accion/a}{direccion}{esMirar(a) $\lor$ esMover(a)}

    \tadGeneradores
        \tadOperacion{mover}{direccion}{accion}{}
        \tadOperacion{mirar}{direccion}{accion}{}
        \tadOperacion{disparar}{}{accion}{}
        \tadOperacion{nada}{}{accion}{}

    \tadOtrasOperaciones
        \tadOperacion{ubicacionLuegoDe}{accion/a,hab/h,ubicacion/u}{conj(pos)}{esValida?(h, pos(u))}
        \tadOperacion{posicionesAfectadasPor}{accion/a,hab/h,ubicacion/u}{conj(pos)}{esValida?(h, pos(u))}
        \tadOperacion{$\neg$ \argumento}{accion}{accion}{}
        \tadOperacion{invertir}{hab/h,ubicacion/u,secu(accion)}{secu(accion)}{esValida?(h, pos(u))}

    \tadAlinearAxiomas{posicionesAfectadasPor(mover(d), h, u)}
    \tadAxiomas[\paratodo{nat}{n, m}, \paratodo{ubicacion}{u}, \paratodo{habitacion}{a}]
        \tadAxioma{posicionesAfectadasPor(mover(d), h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(mirar(d), h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(nada, h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(disparar, h, u)}{
            \IF esValida?(h, proxPosEnDir(dir(u), pos(u)) $\yluego$ \\
            $\neg$estaOcupada?(h, proxPosEnDir(dir(u), pos(u))) \\
            THEN Ag(proxPosEnDir(dir(u), pos(u)), \\ 
            posicionesAfectadasPor(disparar,h, \\
            $\langle$proxPosEnDir(dir(u), pos(u)), dir(u)$\rangle$)) \\
            ELSE $\emptyset$ 
            FI}
        \tadAxioma{invertir(h, u, as)}{
            \IF vacia?(as) 
            THEN $<>$ 
            ELSE invertir(h, ubicacionLuegoDe(prim(as), h, u), fin(as)) $\lor$  $\neg$(prim(as), h, u)
            FI
        }
        \tadAxioma{$\neg$(mover(d), h, u)}{
            \IF pos(ubicacionLuegoDe(mover(d), h, u)) = pos(u) \\
            THEN mirar(opuesta(d))
            ELSE mover(opuesta(d))
            FI
        }
        \tadAxioma{$\neg$(mirar(d), h, u)}{mirar(opuesta(d))}
        \tadAxioma{$\neg$(disparar, h, u)}{disparar}
        \tadAxioma{$\neg$(nada, h, u)}{nada}
        \tadAxioma{ubicacionLuegoDe(nada, h, u)}{u}
        \tadAxioma{ubicacionLuegoDe(disparar, h, u)}{u}
        \tadAxioma{ubicacionLuegoDe(mirar(d), h, u)}{$\langle$pos(u), d$\rangle$}
        \tadAxioma{ubicacionLuegoDe(mover(d), h, u)}{
            $\langle$(\IF esValida?(h, proxPosEnDir(d, pos(u))) $\yluego$ \\
            $\neg$estaOcupada?(h, proxPosEnDir(d, pos(u))) \\
            THEN proxPosEnDir(d, pos(u))
            ELSE pos(u)
            FI), d$\rangle$
            }
        \tadAxioma{esMirar(mirar(d))}{true}
        \tadAxioma{esMirar(mover(d))}{false}
        \tadAxioma{esMirar(disparar)}{false}
        \tadAxioma{esMirar(nada)}{false}
        \tadAxioma{esMover(mirar(d))}{false}
        \tadAxioma{esMover(mover(d))}{true}
        \tadAxioma{esMover(disparar)}{false}
        \tadAxioma{esMover(nada)}{false}
        \tadAxioma{esDisparar(mirar(d))}{false}
        \tadAxioma{esDisparar(mover(d))}{false}
        \tadAxioma{esDisparar(disparar)}{true}
        \tadAxioma{esDisparar(nada)}{false}
        \tadAxioma{esNada(mirar(d))}{false}
        \tadAxioma{esNada(mover(d))}{false}
        \tadAxioma{esNada(disparar)}{false}
        \tadAxioma{esNada(nada)}{true}
        \tadAxioma{direccion(mirar(d))}{d}
        \tadAxioma{direccion(mover(d))}{d}
\end{tad}

\end{document}