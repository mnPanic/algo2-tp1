\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}

\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}

\sloppy

\hypersetup{%
 % Para que el PDF se abra a pagina completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={C�tedra de Algoritmos y Estructuras de Datos II - DC - UBA},
 pdfkeywords={TADs basicos},
 pdfsubject={Tipos abstractos de datos basicos}
}

\parskip=5pt % 10pt es el tama�o de fuente

% Pongo en 0 la distancia extra entre �temes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Algoritmos y Estructuras de Datos II}
\rhead{$1^{\mathrm{er}}$ cuatrimestre de 2019}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\author{Algoritmos y Estructuras de Datos II, DC, UBA.}
\date{}
\title{Tipos abstractos de datos b�sicos}

\begin{document}
%Pagina de titulo e indice
\thispagestyle{empty}

\maketitle
\tableofcontents

\newpage

% TADs

\section{TAD \tadNombre{Juego}}
\begin{tad}{\tadNombre{Juego}}
    \tadGeneros{juego}
    \tadExporta{TODO}
    \tadUsa{\tadNombre{Habitacion}}

    \tadIgualdadObservacional{j}{j'}{juego}{$(n=0? \igobs m=0?)\ \yluego$\\ $(\neg(n=0?) \impluego (\text{pred}(n) \igobs \text{pred}(m)))$}
    \tadIgualdadObservacional{j}{j'}{juego}{
        (accionesPJs(j) $\igobs$ accionesPJs(j')) $\land$ \\
        (accionesFan(j) $\igobs$ accionesFan(j')) $\land$ \\
        (localizarJugadores(j) $\igobs$ localizarJugadores(j')) $\land$ \\
        (hab(j) $\igobs$ hab(j')) $\land$ \\
        (($\forall$ p : pj) (vivePJ?(j, p) \igobs vivePJ?(j', p))) $\land$ \\
        (($\forall$ f : fantasma) ((viveFan?(j, p) \igobs viveFan?(j', p)) $\land$ \\
                                   (ubicacionInicialFan(j, f) \igobs ubicacionInicialFan(j', f)))
    }

    
    \tadAlinearFunciones{ubicacionInicialFan}{conj(pj)/pjs, secu(accion)/as}

    \tadObservadores
        \tadOperacion{accionesPJs}{juego}{dicc(pj, secu(accion))}{}
        \tadOperacion{accionesFan}{juego}{dicc(pj, secu(accion))}{}
        \tadOperacion{hab}{juego}{hab}{}
        \tadOperacion{vivePJ?}{juego/j, pj/p}{bool}{p $\in$ jugadores(j)}
        \tadOperacion{viveFan?}{juego/j, fantasma/f}{bool}{f $\in$ fantasmas(j)}
        \tadOperacion{ubicacionInicialFan}{juego/j, fantasma/f}{ubicacion}{f $\in$ fantasmas(f)}
        \tadOperacion{localizarJugadores}{juego}{dicc(pj, ubicacion)}{}
    
    \tadGeneradores
        \tadOperacion{iniciar}
            {conj(pj)/pjs, secu(accion)/as, ubicacion/u, hab/h}
            {juego}
            {esConexa?(h) $\land$ $\neg$ $\emptyset$?(as) $\land$ $\neg$ $\emptyset$?(pjs) $\land$ esValida?(h, pos(u))}

        \tadOperacion{proxPaso}
            {juego/j, pj/p, accion/a}
            {juego}
            {p $\in$ jugadores(j) $\yluego$ vivePJ?(j, p) $\land$ $\neg$ termino?(j) $\land$ $\neg$ esMirar(a)}
    \tadOtrasOperaciones

    \tadAxiomas[\paratodo{nat}{n, m}]
    \tadAlinearAxiomas{pred(suc($n$))}
    \tadAxioma{$0=0?$}{true}

\end{tad}

\section{TAD \tadNombre{Habitacion}}

\begin{tad}{\tadNombre{Habitacion}}
  \tadGeneros{hab}
  \tadExporta{hab, observadores, generadores, esConexa?}
  \tadUsa{\tadNombre{posicion, bool, nat}}

  \tadIgualdadObservacional{h}{h'}{hab}{$(\forall p:\text{posicion})$(esValida?($p, h$) $\igobs$ esValida?($p, h'$) $\yluego$ \\ (esValida?($p, h$) $\impluego$ \\(estaOcupada?($p, h$) $\igobs$ estaOcupada?($p, h'$))))}
  \tadAlinearFunciones{verificarAlcancePos}{hab,conj(posicion),conj(posicion)}


  \tadObservadores
    \tadOperacion{esValida?}{hab,posicion}{bool}{} %Decisión tomada, tiene que ser de 2 o mas porque sino nadie muere.
    \tadOperacion{estaOcupada?}{hab/h,posicion/p}{bool}{esValida?(h, p)}

  \tadGeneradores
    \tadOperacion{nueva}{nat/n}{hab}{n>1}
    \tadOperacion{ocupar}{hab/h,posicion/p}{hab}{esValida?(h, p) \yluego $\neg$ estaOcupada?(h, p)}

  \tadOtrasOperaciones
    \tadOperacion{esConexa?}{hab}{bool}{}
    \tadOperacion{tamano}{hab}{nat}{}
    \tadOperacion{posiciones}{hab}{conj(posicion)}{}
    \tadOperacion{posicionesLibres}{hab/h,conj(posicion)/ps}{conj(posicion)}{ps $\subseteq$ posiciones(h)}
    \tadOperacion{verificarAlcance}{hab/h,conj(posicion)/ps}{bool}{ps $\subseteq$ posiciones(h)}
    \tadOperacion{verificarAlcancePos}{hab/h,conj(posicion)/ps,posicion/p}{bool}{ps $\subseteq$ posiciones(h) $\land$ p $\in$ posiciones(h)}

\tadAlinearFunciones{estaOcupada?(ocupar(h,p'),p)}{}

  \tadAxiomas[\paratodo{hab}{h} \paratodo{conj(posicion)}{ps} \paratodo{posicion}{p} \paratodo{nat}{n,k,tam}]
  \tadAlinearAxiomas{estaOcupada?(ocupar(h,p'),p)}
    \tadAxioma{esValida?(nueva(n),p)}{0 $\leq$ $\Pi_1$(p) < \ n $\land$ 0 $\leq$ $\Pi_2$(p) < \ n}
    
    \tadAxioma{esValida?(ocupar(h,p'),p)}{p = p' \oluego \ esValida?(h, p)}
    
    \tadAxioma{estaOcupada?(nueva(n),p)}{false}
    
    \tadAxioma{estaOcupada?(ocupar(h,p'),p)}{p = p' $\lor$ estaOcupada?(h, p)}
    
    \tadAxioma{tamano(nueva(n))}{n}
    
    \tadAxioma{tamano(ocupar(h, p))}{tamano(h)}
    
    \tadAxioma{esConexa?(h)}{verificarAlcance(h, posicionesLibres(posiciones(h)))}

   \tadAxioma{posicionesLibres(h, ps)}{\textbf{if} \ $\emptyset?(ps)$ \\ \textbf{then} \ $\emptyset$ \\ \textbf{else} \\ (\textbf{if} estaOcupada?(h, dameUno(ps)) \textbf{then} \ $\emptyset$ \textbf{else} \{dameUno(ps)\} \textbf{fi}) \\ $\cup$ posicionesLibres(h, sinUno(ps)) \\ \textbf{fi}}

    \tadAxioma{verificarAlcance(h, ps)}{\textbf{if} \ $\emptyset?(ps)$ \\ \textbf{then} \ true \\ \textbf{else} \\ verificarAlancePos(h, ps, dameUno(ps)) $\land$ verificarAlcance(h, p) \\ \textbf{fi}}
    
    \tadAxioma{verificarAlcancePos(h, ps, p)}{\textbf{if} \ $\emptyset?(ps)$ \\ \textbf{then} \ true \\ \textbf{else} \\ esAlcanzable(h, p, dameUno(ps)) $\land$ verificarAlcancePos(h, p, sinUno(ps)) \\ \textbf{fi}}

    \tadAxioma{posiciones(h)}{darPosiciones(h, tamano(h) - 1, tamano(h) - 1, tamano(h) - 1)}

    \tadAxioma{darPosiciones(h, n, k, tam)}{\textbf{if} \ $n = 0? \land k = 0?$ \\ \textbf{then} \ $\emptyset$ \\ \textbf{else if} $k = 0?$ \\ \textbf{then} \ Ag((n,k), darPosiciones(h, n - 1, tam, tam)) \\ \textbf{else} \ Ag((n,k), darPosiciones(h, n, k - 1, tam))  \\ \textbf{fi} \\ \textbf{fi}}

\end{tad}

\section{TAD \tadNombre{Accion}}
\begin{tad}{\tadNombre{Accion}}
    \tadGeneros{accion}
    
    \tadExporta{observadores, generadores, genero, otras operaciones}

    \tadIgualdadObservacional{a}{a'}{accion}{
        esNada(a) $\igobs$ esNada(a') $\land$ \\
        esDisparar(a) $\igobs$ esDisparar(a') $\land$ \\
        esMover(a) $\igobs$ esMover(a') $\land$ \\
        esMirar(a) $\igobs$ esMirar(a') $\land$ \\
        ((esMover(a) $\lor$ esMirar(a)) $\impluego$ direccion(a) $\igobs$ direccion(a'))
    }

    \tadAlinearFunciones{posicionesAfectadasPor}{hab/h,ubicacion/u,secu(accion)}{secu(accion)}{}
    
    \tadObservadores
        \tadOperacion{esMover}{accion}{bool}{}
        \tadOperacion{esMirar}{accion}{bool}{}
        \tadOperacion{esDisparar}{accion}{bool}{}
        \tadOperacion{esNada}{accion}{bool}{}
        \tadOperacion{direccion}{accion/a}{direccion}{esMirar(a) $\lor$ esMover(a)}

    \tadGeneradores
        \tadOperacion{mover}{direccion}{accion}{}
        \tadOperacion{mirar}{direccion}{accion}{}
        \tadOperacion{disparar}{}{accion}{}
        \tadOperacion{nada}{}{accion}{}

    \tadOtrasOperaciones
        \tadOperacion{ubicacionLuegoDe}{accion/a,hab/h,ubicacion/u}{conj(pos)}{esValida?(h, pos(u))}
        \tadOperacion{posicionesAfectadasPor}{accion/a,hab/h,ubicacion/u}{conj(pos)}{esValida?(h, pos(u))}
        \tadOperacion{$\neg$ \argumento}{accion}{accion}{}
        \tadOperacion{invertir}{hab/h,ubicacion/u,secu(accion)}{secu(accion)}{esValida?(h, pos(u))}

    \tadAlinearAxiomas{posicionesAfectadasPor(mover(d), h, u)}
    \tadAxiomas[\paratodo{nat}{n, m}, \paratodo{ubicacion}{u}, \paratodo{habitacion}{a}]
        \tadAxioma{posicionesAfectadasPor(mover(d), h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(mirar(d), h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(nada, h, u)}{$\emptyset$}
        \tadAxioma{posicionesAfectadasPor(disparar, h, u)}{
            \textbf{if} esValida?(h, proxPosEnDir(dir(u), pos(u)) $\yluego$ \\
            $\neg$estaOcupada?(h, proxPosEnDir(dir(u), pos(u))) \\
            \textbf{then} \\ Ag(proxPosEnDir(dir(u), pos(u)),posicionesAfectadasPor(disparar,h, $\langle$proxPosEnDir(dir(u), pos(u)), dir(u)$\rangle$)) \\
            \textbf{else} $\emptyset$ \\
            \textbf{fi}}

        \tadAxioma{invertir(h, u, as)}{
            \textbf{if} vacia?(as) \\
            \textbf{then} $<>$ \\ 
            \textbf{else} \\ 
            invertir(h, ubicacionLuegoDe(prim(as), h, u), fin(as)) $\lor$ $\neg$(prim(as), h, u) \\
            \textbf{fi}
        }
        \tadAxioma{$\neg$(mover(d), h, u)}{
            \textbf{if} pos(ubicacionLuegoDe(mover(d), h, u)) = pos(u) \\
            \textbf{then} mirar(opuesta(d)) \\
            \textbf{else} mover(opuesta(d)) \\
            \textbf{fi}
        }
        \tadAxioma{$\neg$(mirar(d), h, u)}{mirar(opuesta(d))}
        \tadAxioma{$\neg$(disparar, h, u)}{disparar}
        \tadAxioma{$\neg$(nada, h, u)}{nada}
        \tadAxioma{ubicacionLuegoDe(nada, h, u)}{u}
        \tadAxioma{ubicacionLuegoDe(disparar, h, u)}{u}
        \tadAxioma{ubicacionLuegoDe(mirar(d), h, u)}{$\langle$pos(u), d$\rangle$}
        \tadAxioma{ubicacionLuegoDe(mover(d), h, u)}{
            $\langle$(\textbf{if} esValida?(h, proxPosEnDir(d, pos(u))) $\yluego$ \\
            $\neg$estaOcupada?(h, proxPosEnDir(d, pos(u))) \\
            \ \textbf{then} proxPosEnDir(d, pos(u)) \\
            \ \textbf{else} pos(u) \\
            \ \textbf{fi}), d$\rangle$
            }
        \tadAxioma{esMirar(mirar(d))}{true}
        \tadAxioma{esMirar(mover(d))}{false}
        \tadAxioma{esMirar(disparar)}{false}
        \tadAxioma{esMirar(nada)}{false}
        \tadAxioma{esMover(mirar(d))}{false}
        \tadAxioma{esMover(mover(d))}{true}
        \tadAxioma{esMover(disparar)}{false}
        \tadAxioma{esMover(nada)}{false}
        \tadAxioma{esDisparar(mirar(d))}{false}
        \tadAxioma{esDisparar(mover(d))}{false}
        \tadAxioma{esDisparar(disparar)}{true}
        \tadAxioma{esDisparar(nada)}{false}
        \tadAxioma{esNada(mirar(d))}{false}
        \tadAxioma{esNada(mover(d))}{false}
        \tadAxioma{esNada(disparar)}{false}
        \tadAxioma{esNada(nada)}{true}
        \tadAxioma{direccion(mirar(d))}{d}
        \tadAxioma{direccion(mover(d))}{d}
\end{tad}

\section{TAD \tadNombre{Direccion}}
\begin{tad}{\tadNombre{Direccion}}
    \tadGeneros{direccion}
    \tadExporta{observadores, generadores, otras operaciones}
    \tadIgualdadObservacional{d}{d'}{direccion}{
        esArriba(d) $\igobs$ esArriba(d') $\land$ \\
        esAbajo(d) $\igobs$ esAbajo(d') $\land$ \\
        esIzquierda(d) $\igobs$ esIzquierda(d') $\land$ \\ 
        esDerecha(d) $\igobs$ esDerecha(d')
    }
    \tadAlinearFunciones{proxPosEnDir}{direccion, posicion}{}
    \tadObservadores
        \tadOperacion{esArriba}{direccion}{bool}{}
        \tadOperacion{esAbajo}{direccion}{bool}{}
        \tadOperacion{esIzquierda}{direccion}{bool}{}
        \tadOperacion{esDerecha}{direccion}{bool}{}

    \tadGeneradores
        \tadOperacion{arriba}{}{direccion}{}
        \tadOperacion{abajo}{}{direccion}{}
        \tadOperacion{izquierda}{}{direccion}{}
        \tadOperacion{derecha}{}{direccion}{}
    
    \tadOtrasOperaciones
        \tadOperacion{opuesta}{direccion}{direccion}{}
        \tadOperacion{proxPosEnDir}{direccion, posicion}{posicion}{}

    \tadAlinearAxiomas{proxPosEnDir(izquierda, p)}
    \tadAxiomas
        \tadAxioma{opuesta(arriba)}{abajo}
        \tadAxioma{opuesta(abajo)}{arriba}
        \tadAxioma{opuesta(izquierda)}{derecha}
        \tadAxioma{opuesta(derecha)}{izquierda}
        \tadAxioma{proxPosEnDir(arriba, p)}{$\langle \Pi_1$(p), $\Pi_2$(p) + 1$\rangle$}
        \tadAxioma{proxPosEnDir(abajo, p)}{$\langle \Pi_1$(p), $\Pi_2$(p) - 1$\rangle$}
        \tadAxioma{proxPosEnDir(izquierda, p)}{$\langle\Pi_1$(p) - 1, $\Pi_2$(p)$\rangle$}
        \tadAxioma{proxPosEnDir(derecha, p)}{$\langle \Pi_1$(p) + 1, $\Pi_2$(p)$\rangle$}
        \tadAxioma{esArriba(arriba)}{true}
        \tadAxioma{esArriba(abajo)}{false}
        \tadAxioma{esArriba(izquierda)}{false}
        \tadAxioma{esArriba(derecha)}{false}
        \tadAxioma{esAbajo(arriba)}{false}
        \tadAxioma{esAbajo(abajo)}{true}
        \tadAxioma{esAbajo(izquierda)}{false}
        \tadAxioma{esAbajo(derecha)}{false}
        \tadAxioma{esIzquierda(arriba)}{false}
        \tadAxioma{esIzquierda(abajo)}{false}
        \tadAxioma{esIzquierda(izquierda)}{true}
        \tadAxioma{esIzquierda(derecha)}{false}
        \tadAxioma{esDerecha(arriba)}{false}
        \tadAxioma{esDerecha(abajo)}{false}
        \tadAxioma{esDerecha(izquierda)}{false}
        \tadAxioma{esDerecha(derecha)}{true}

    
\end{tad}{}

\section{\tadNombre{Extensiones y Renombres}}

\textbf{TAD} \tadNombre{Fantasma} \textbf{ES} \tadNombre{Nat} \\ \\
\textbf{TAD} \tadNombre{PJ} \textbf{ES} \tadNombre{Nat} \\ \\
\textbf{TAD} \tadNombre{Posicion} \textbf{ES} \tadNombre{tupla(nat, nat)}

\begin{tad}{\tadNombre{Nat} \textbf{extiende} \tadNombre{Nat}}

\tadOtrasOperaciones
    \tadOperacion{$\bullet \ \% \ \bullet$}{nat, nat}{nat}{}
    \tadAxiomas[\paratodo{nat}{n,m}]
    \tadAxioma{n $\%$ m}{\textbf{if} n < \ m \textbf{then} n \textbf{else} (n - m) $\%$ m \textbf{fi}}
\end{tad}

\begin{tad}{\tadNombre{Ubicacion} \textbf{extiende} \tadNombre{tupla(posicion, direccion)}}
\tadOtrasOperaciones
    \tadOperacion{pos}{ubicacion}{posicion}{}
    \tadOperacion{dir}{ubicacion}{direccion}{}
    \tadAxiomas[\paratodo{ubicacion}{u}]
    \tadAxioma{pos(u)}{$\Pi_1$(u)}
    \tadAxioma{dir(u)}{$\Pi_2$(u)}
\end{tad}

\begin{tad}{\tadNombre{Secuencia} \textbf{extiende} \tadNombre{Secuencia}}
\tadOtrasOperaciones
    \tadOperacion{$\bullet[\bullet]$}{secu($\alpha$)/s, nat/i}{$\alpha$}{i < \ long(s)}
    \tadAxiomas[\paratodo{secu($\alpha$)}{s}, \paratodo{nat}{i}]
    \tadAxioma{s$[i]$}{\textbf{if} $i = 0?$ \textbf{then} prim(s) \textbf{else} fin(s)$[i - 1]$ \textbf{fi}}
\end{tad}


\end{document}